---
name: init
description: Initialize a project for Teamwerk agent teams â€” sets up environment, generates PRD and acceptance criteria
user_invocable: true
---

Initialize the current project for Teamwerk agent teams.

## Steps

1. **Check prerequisites and auto-fix.**

   Run these checks in order. Fix what you can, guide the user on the rest:

   a. **tmux**: Run `which tmux`. If not found:
      - On macOS: Ask "tmux is required for agent teams. Want me to install it? (`brew install tmux`)"
      - On Linux: Ask "tmux is required. Want me to install it? (`sudo apt install tmux`)"
      - If user agrees, run the install command. If not, stop and explain it's required.

   b. **Node.js**: Run `which node`. If not found, tell the user: "Node.js is required for the test linter and report generator. Install it from https://nodejs.org" and stop.

   c. **Environment variable**: Check if `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS` is set by running `echo $CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS`. If empty or not "1":
      - Tell the user: "Agent Teams requires an environment variable. Add this to your shell profile:"
      - Provide: `echo 'export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1' >> ~/.zshrc && source ~/.zshrc`
      - (Use `~/.bashrc` if they're on bash)
      - Note: This takes effect on next session. For this session, it will be set by the launch script.

   d. **Already initialized?**: Check if `docs/prd.md` exists. If it does, ask: "This project has already been initialized. Do you want to re-initialize (overwrite existing docs) or skip to /launch-team?"

2. **Discover the project** (silently, no user interaction needed).

   Examine the project directory to detect:
   - **Tech stack**: Look for `package.json`, `*.csproj`, `requirements.txt`, `pyproject.toml`, `Cargo.toml`, `go.mod`, `pom.xml`, `build.gradle`
   - **Existing test infrastructure**: Look for `tests/`, `test/`, `__tests__/`, `spec/`, `Tests/` directories
   - **Existing documentation**: Look for `docs/`, `README.md`, `CLAUDE.md`
   - **Stack overlay**: Based on detected stack, determine which Teamwerk overlay applies (express, dotnet, react, angular, react-native-expo)

3. **Source the PRD.**

   Ask the user:

   > "Do you have a project document already (PRD, spec, project charter), or would you like to brainstorm one?"

   **If they have a document:**
   - Ask: "Where is it? Give me the file path, URL, or paste the content."
   - If it's a file path: Read the file
   - If it's a URL: Fetch and parse it
   - If they mention Azure DevOps or Jira: Say "Direct ADO/Jira integration is coming in a future version. For now, you can export it as markdown, paste the content here, or point me to a file."
   - Once you have the content, use the **project-analyst** skill in parse mode to normalize it into Teamwerk's PRD format

   **If they want to brainstorm:**
   - Use the **project-analyst** skill in brainstorm mode
   - Guide the interactive conversation (elevator pitch â†’ users â†’ stack â†’ features â†’ constraints â†’ out of scope)
   - Generate the PRD from the conversation

4. **Generate project files.**

   After the PRD and acceptance criteria are generated by the project-analyst skill:

   a. **`teamwerk-config.yml`**: Create at project root with:
      - Project name (from PRD)
      - Acceptance criteria path: `docs/acceptance-criteria.md`
      - Test directories (detected or default)
      - Test file patterns (based on stack)
      - Report output path
      - Stack overlay (detected)
      - Team roles (all 6 by default)

   b. **`CLAUDE.md`**: Create or append to the project's CLAUDE.md with:
      ```
      ## Teamwerk Project Configuration

      ### Source of Truth
      - **PRD**: docs/prd.md â€” defines what we're building and why
      - **Acceptance Criteria**: docs/acceptance-criteria.md â€” defines done
      - **Config**: teamwerk-config.yml â€” project configuration

      ### Rules
      - Every code change must trace to a functional requirement (FR) in the PRD
      - Every test must reference an acceptance criterion (AC) by ID
      - Rule Zero: Tests must NEVER modify the application under test
      - See the test-quality-standards skill for test quality requirements

      ### Stack
      [Detected stack info and overlay]
      ```

5. **Print the ready check summary.**

   Display a clear summary:
   ```
   === Teamwerk Initialized ===

   âœ… tmux: ready
   âœ… Node.js: ready
   âœ… Environment: configured

   ğŸ“„ PRD: docs/prd.md
   ğŸ“‹ Acceptance Criteria: docs/acceptance-criteria.md (X ACs from Y FRs)
   âš™ï¸  Config: teamwerk-config.yml ([overlay] overlay)
   ğŸ“ CLAUDE.md: updated

   Next: Review your docs, then run /launch-team to start the agent team.
   ```
